[
  {
    "path": "posts/2022-06-10-many-small-models-the-secret-weapon/",
    "title": "Many small models -- the Secret Weapon",
    "description": "how to fit and visualize small multiples",
    "author": [
      {
        "name": "Allen and Andrew",
        "url": {}
      }
    ],
    "date": "2022-06-10",
    "categories": [],
    "contents": "\r\n\r\n\r\nsubstrate <- c(\"soil\", \"onion\", \"radish\", \"broccoli\", \"soy\", \"corn\")\r\n\r\ngenotypes <- c(\"H\", \"N\")\r\n\r\nlibrary(tidyverse)\r\n\r\n\r\ntreatment <- expand_grid(substrate, genotypes)\r\n\r\n\r\nfly_ids <- paste0(\"fly\", 1:(30*12))\r\n\r\n# assign flies to treatments\r\n\r\ntrt_id <- rep(1:12, times = 30)\r\n\r\ndesign_matrix <- tibble(fly_ids, trt_id) |> \r\n  rowwise() |> \r\n  mutate(trt = list(treatment[trt_id,])) |> \r\n  unnest(\"trt\")\r\n\r\nobs_flies <- design_matrix |> \r\n  rowwise() |> \r\n  mutate(time = list(c(\"t1\", \"t2\", \"t3\"))) |> \r\n  unnest(time) |> \r\n  mutate(obs = rnorm(length(fly_ids), mean = 40, sd = sqrt(40)))\r\n\r\n# faster simpler \r\nexpand_grid(genotype = c(\"H\", \"N\"),\r\n            substrate = c(\"control\", \"onion\", \"radish\", \"broco\", \"soy\", \"corn\"),\r\n            flies = 1:30,\r\n            time = c(\"4\", \"24\", \"48\")) %>%\r\n  group_by(genotype, substrate) %>%\r\n  mutate(fly_id = cur_group_id()) %>%\r\n  ungroup()\r\n\r\n\r\n# A tibble: 1,080 x 5\r\n   genotype substrate flies time  fly_id\r\n   <chr>    <chr>     <int> <chr>  <int>\r\n 1 H        control       1 4          2\r\n 2 H        control       1 24         2\r\n 3 H        control       1 48         2\r\n 4 H        control       2 4          2\r\n 5 H        control       2 24         2\r\n 6 H        control       2 48         2\r\n 7 H        control       3 4          2\r\n 8 H        control       3 24         2\r\n 9 H        control       3 48         2\r\n10 H        control       4 4          2\r\n# ... with 1,070 more rows\r\n\r\nFit many small models to each one!\r\n\r\n\r\nfly_model_df <- obs_flies |> \r\n  mutate(time = factor(time, levels = c(\"t3\", \"t1\", \"t2\"))) |> \r\n  nest_by(substrate, genotypes, .key = \"flydata\")\r\n\r\nfly_model_coefs <- fly_model_df |> \r\n  # fit models\r\n  mutate(model = list(lm(obs ~ time, data = flydata))) |> \r\n  # mutate(coef = list(coef(model))) # there's a cooler way! \r\n  mutate(tb = list(broom::tidy(model))) |> \r\n  unnest(cols = c(\"tb\"))\r\n\r\nfly_model_coefs |> \r\n  filter(term == \"(Intercept)\") |> \r\n  ggplot(aes(y = estimate, x = substrate, col = genotypes, ymin = estimate - std.error, ymax = estimate + std.error)) + \r\n  geom_pointrange(position = position_dodge(width = .1))\r\n\r\n\r\n\r\n\r\ncould do it again for another kind of preference: the contrast\r\nbetween t1 and t3\r\n\r\n\r\nfly_model_coefs |> \r\n  filter(term == \"timet1\") |> \r\n  ggplot(aes(y = estimate, x = substrate, col = genotypes, \r\n             ymin = estimate - std.error, ymax = estimate + std.error)) + \r\n  geom_pointrange(position = position_dodge(width = .1))\r\n\r\n\r\n\r\n\r\nwhat about for a zero-inflated model?\r\n\r\n\r\nlibrary(glmmTMB)\r\n\r\nobs_flies_zi <- obs_flies |> \r\n  mutate(time = factor(time, levels = c(\"t3\", \"t1\", \"t2\")),\r\n         obs = if_else(runif(1080)<.1, true = 0, false = obs)) \r\n\r\n\r\nobs_flies_zi |> \r\n  nest_by(substrate, genotypes, .key = \"flydata\") |> \r\n  mutate(zi_mod = list(glmmTMB(obs ~ time, ziformula = ~time, data = flydata)))\r\n\r\n\r\n# A tibble: 12 x 4\r\n# Rowwise:  substrate, genotypes\r\n   substrate genotypes            flydata zi_mod   \r\n   <chr>     <chr>     <list<tibble[,4]>> <list>   \r\n 1 broccoli  H                   [90 x 4] <glmmTMB>\r\n 2 broccoli  N                   [90 x 4] <glmmTMB>\r\n 3 corn      H                   [90 x 4] <glmmTMB>\r\n 4 corn      N                   [90 x 4] <glmmTMB>\r\n 5 onion     H                   [90 x 4] <glmmTMB>\r\n 6 onion     N                   [90 x 4] <glmmTMB>\r\n 7 radish    H                   [90 x 4] <glmmTMB>\r\n 8 radish    N                   [90 x 4] <glmmTMB>\r\n 9 soil      H                   [90 x 4] <glmmTMB>\r\n10 soil      N                   [90 x 4] <glmmTMB>\r\n11 soy       H                   [90 x 4] <glmmTMB>\r\n12 soy       N                   [90 x 4] <glmmTMB>\r\n\r\nFrom easystats documentation\r\n\r\n\r\nlibrary(parameters)\r\nmodel <- glmmTMB(\r\n  count ~ spp + mined + (1 | site),\r\n  ziformula = ~mined,\r\n  family = poisson(),\r\n  data = Salamanders\r\n)\r\n\r\nsimulate_parameters(model, centrality = \"mean\")\r\n\r\n\r\n# Fixed Effects\r\n\r\nParameter   | Coefficient |         95% CI |      p\r\n---------------------------------------------------\r\n(Intercept) |       -0.36 | [-0.89,  0.21] | 0.222 \r\nsppPR       |       -1.27 | [-1.72, -0.80] | < .001\r\nsppDM       |        0.27 | [ 0.00,  0.53] | 0.054 \r\nsppEC-A     |       -0.56 | [-0.98, -0.17] | 0.002 \r\nsppEC-L     |        0.67 | [ 0.42,  0.91] | < .001\r\nsppDES-L    |        0.63 | [ 0.38,  0.86] | < .001\r\nsppDF       |        0.12 | [-0.16,  0.39] | 0.438 \r\nminedno     |        1.26 | [ 0.75,  1.79] | < .001\r\n\r\n# Zero-Inflated\r\n\r\nParameter      | Coefficient |         95% CI |      p\r\n------------------------------------------------------\r\n(Intercept)_zi |        0.79 | [ 0.28,  1.30] | 0.008 \r\nminedno_zi     |       -1.85 | [-2.43, -1.27] | < .001\r\n\r\nsimulate_parameters(model, ci = c(.8, .95), component = \"zero_inflated\")\r\n\r\n\r\n# Fixed Effects\r\n\r\nParameter   | Coefficient |         80% CI |         95% CI |      p\r\n--------------------------------------------------------------------\r\n(Intercept) |        0.80 | [ 0.44,  1.14] | [ 0.24,  1.33] | 0.006 \r\nminedno     |       -1.85 | [-2.25, -1.45] | [-2.51, -1.20] | < .001\r\n\r\nbootstrapping a dataframe\r\n\r\n\r\none_sample <- obs_flies_zi |> \r\n  nest(timeobs = c(time, obs)) |> \r\n  # group by experimental factors\r\n  group_by(substrate, genotypes) |> \r\n  sample_frac(size = 1, replace = TRUE)\r\n\r\none_sample |> \r\n  filter(trt_id == 1) |> \r\n  arrange(fly_ids)\r\n\r\n\r\n# A tibble: 30 x 5\r\n# Groups:   substrate, genotypes [1]\r\n   fly_ids trt_id substrate genotypes timeobs         \r\n   <chr>    <int> <chr>     <chr>     <list>          \r\n 1 fly109       1 soil      H         <tibble [3 x 2]>\r\n 2 fly109       1 soil      H         <tibble [3 x 2]>\r\n 3 fly121       1 soil      H         <tibble [3 x 2]>\r\n 4 fly13        1 soil      H         <tibble [3 x 2]>\r\n 5 fly133       1 soil      H         <tibble [3 x 2]>\r\n 6 fly145       1 soil      H         <tibble [3 x 2]>\r\n 7 fly145       1 soil      H         <tibble [3 x 2]>\r\n 8 fly169       1 soil      H         <tibble [3 x 2]>\r\n 9 fly193       1 soil      H         <tibble [3 x 2]>\r\n10 fly205       1 soil      H         <tibble [3 x 2]>\r\n# ... with 20 more rows\r\n\r\none_sample |> \r\n  unnest(timeobs) |> \r\n  ungroup()\r\n\r\n\r\n# A tibble: 1,080 x 6\r\n   fly_ids trt_id substrate genotypes time    obs\r\n   <chr>    <int> <chr>     <chr>     <fct> <dbl>\r\n 1 fly271       7 broccoli  H         t1     39.9\r\n 2 fly271       7 broccoli  H         t2     33.2\r\n 3 fly271       7 broccoli  H         t3     27.4\r\n 4 fly283       7 broccoli  H         t1     41.8\r\n 5 fly283       7 broccoli  H         t2     41.3\r\n 6 fly283       7 broccoli  H         t3     50.9\r\n 7 fly7         7 broccoli  H         t1     42.8\r\n 8 fly7         7 broccoli  H         t2     34.6\r\n 9 fly7         7 broccoli  H         t3     31.2\r\n10 fly187       7 broccoli  H         t1     41.0\r\n# ... with 1,070 more rows\r\n\r\nthat’s one rep, let’s do a lot!\r\n\r\n\r\nboot_list <- rerun(30, {\r\n  obs_flies_zi |> \r\n    nest(timeobs = c(time, obs)) |> \r\n    # group by experimental factors\r\n    group_by(substrate, genotypes) |> \r\n    sample_frac(size = 1, replace = TRUE) |> \r\n    unnest(timeobs) |> \r\n    ungroup()\r\n})\r\n\r\n\r\n\r\nnow just use map to apply a function to each of\r\nthese\r\n\r\n\r\nmodel_list <- boot_list |> \r\n  map(~ glmmTMB(obs ~ time, ziformula = ~time, data = .x))\r\n\r\n# use bootstrapped models to predict on original dataset\r\nmodel_predictions <- map(model_list, \r\n                         predict,\r\n                         type = \"response\",\r\n                         newdata = obs_flies_zi)\r\n\r\n# model_predictions |> map(head)\r\n\r\n# rowMeans(do.call(cbind, model_predictions))\r\n\r\n# get more information though!\r\nboot_pred_df <- model_predictions |> \r\n  map_dfr(enframe, name = \"rownum\", value = \"pred\", .id = \"boot_id\")\r\n\r\n\r\n\r\nsummarize each of these\r\n\r\n\r\nsummarized_data <- boot_pred_df |> \r\n  nest_by(rownum) |> \r\n  mutate(med = median(data$pred),\r\n         quant_lo = quantile(data$pred, 0.025),\r\n         quant_hi = quantile(data$pred, 0.975)) |> \r\n  select(-data)\r\n\r\nbind_cols(obs_flies_zi, summarized_data) |> \r\n  ggplot(aes(x = substrate, y = obs)) + \r\n  geom_count() + \r\n  facet_grid(genotypes ~ time) + \r\n  geom_count(aes(y = med, x = substrate), col = \"orange\") + \r\n  geom_pointrange(aes(y = med, ymin = quant_lo, ymax = quant_hi), col = \"green\")\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-06-10-many-small-models-the-secret-weapon/many-small-models-the-secret-weapon_files/figure-html5/unnamed-chunk-2-1.png",
    "last_modified": "2022-06-10T15:43:59-04:00",
    "input_file": "many-small-models-the-secret-weapon.knit.md"
  },
  {
    "path": "posts/2022-06-06-hybrid-fly-life-history/",
    "title": "Hybrid fly life history",
    "description": "A short description of the post.",
    "author": [
      {
        "name": "Allen and Andrew",
        "url": {}
      }
    ],
    "date": "2022-06-06",
    "categories": [],
    "contents": "\r\nstudying the gamma\r\ndistribution\r\n\\[\r\n\\text{Gamma}(a, b)\r\n\\]\r\n\\[\r\n\\begin{align}\r\n\\mu = a/b \\\\\r\n\\sigma^2 = a/b^2\r\n\\end{align}\r\n\\]\r\n\\[\r\n\\text{Gamma}\\left(\\frac{\\mu^2}{\\sigma^2}, \\frac{\\mu}{\\sigma^2}\\right)\r\n\\]\r\n\\[\r\n\\text{Gamma}(\\mu b, b)\r\n\\]\r\n\\[\r\n\\text{Gamma}\\left(a, \\frac{a}{\\mu}\\right)\r\n\\]\r\n\r\n\r\ngamma_var <- rgamma(n = 570, shape = 6, scale = 1.5)\r\n\r\ngamma_var |> mean()\r\n\r\n\r\n[1] 9.071691\r\n\r\ngamma_var |> sd()\r\n\r\n\r\n[1] 3.595262\r\n\r\n# theoretical average\r\n6*1.5\r\n\r\n\r\n[1] 9\r\n\r\n# theory sd\r\nsqrt(6*1.5^2)\r\n\r\n\r\n[1] 3.674235\r\n\r\nsee the brms\r\nvignettes\r\nbrms uses mean \\(\\mu\\) rate = \\(\\alpha/\\mu\\)\r\n\r\n\r\na <- 3\r\nm <- 16\r\nxx <- rgamma(571, shape = m^2/a^2, rate = m/a^2)\r\nhist(xx)\r\n\r\n\r\n\r\nmean(xx)\r\n\r\n\r\n[1] 16.07129\r\n\r\nsd(xx)\r\n\r\n\r\n[1] 3.023583\r\n\r\n# could also define beta = mean/variance\r\nbeta <- m/a^2\r\nbeta\r\n\r\n\r\n[1] 1.777778\r\n\r\nxx2 <- rgamma(571, shape = m*beta, rate = beta)\r\nmean(xx2)\r\n\r\n\r\n[1] 16.08252\r\n\r\nsd(xx2)\r\n\r\n\r\n[1] 2.923598\r\n\r\nANdrew is going to ask in the Stan forum WTF is happening when you\r\nuse the gamma family – why does LF behave differently thank the\r\nalternative\r\n\r\n\r\nlibrary(tidybayes)\r\n        \r\n## the Stan and brms parameterization of gamma translates into R like this: \r\n\r\nmean <- 42\r\nshape <- 2\r\n\r\nrr <- rgamma(300, shape, shape/mean)\r\n\r\n\r\nrr |> mean()\r\n\r\n\r\n[1] 40.62313\r\n\r\nrr |> sd()\r\n\r\n\r\n[1] 29.29415\r\n\r\nrr |> var()\r\n\r\n\r\n[1] 858.1472\r\n\r\n42^2/2\r\n\r\n\r\n[1] 882\r\n\r\ngamma_form <- bf(xx ~ 1,\r\n                 family = brmsfamily(\"Gamma\",\r\n                                     link = \"identity\",\r\n                                     link_shape = \"identity\")) + \r\n  lf(shape ~ 1)\r\n\r\nmake_stancode(gamma_form, data = data.frame(xx))\r\n\r\n\r\n// generated with brms 2.16.6\r\nfunctions {\r\n}\r\ndata {\r\n  int<lower=1> N;  // total number of observations\r\n  vector[N] Y;  // response variable\r\n  int prior_only;  // should the likelihood be ignored?\r\n}\r\ntransformed data {\r\n}\r\nparameters {\r\n  real Intercept;  // temporary intercept for centered predictors\r\n  real Intercept_shape;  // temporary intercept for centered predictors\r\n}\r\ntransformed parameters {\r\n  real lprior = 0;  // prior contributions to the log posterior\r\n  lprior += student_t_lpdf(Intercept | 3, 15.8, 2.8);\r\n  lprior += gamma_lpdf(Intercept_shape | 0.01, 0.01);\r\n}\r\nmodel {\r\n  // likelihood including constants\r\n  if (!prior_only) {\r\n    // initialize linear predictor term\r\n    vector[N] mu = Intercept + rep_vector(0.0, N);\r\n    // initialize linear predictor term\r\n    vector[N] shape = Intercept_shape + rep_vector(0.0, N);\r\n    for (n in 1:N) {\r\n      // apply the inverse link function\r\n      mu[n] = shape[n] / (mu[n]);\r\n    }\r\n    target += gamma_lpdf(Y | shape, mu);\r\n  }\r\n  // priors including constants\r\n  target += lprior;\r\n}\r\ngenerated quantities {\r\n  // actual population-level intercept\r\n  real b_Intercept = Intercept;\r\n  // actual population-level intercept\r\n  real b_shape_Intercept = Intercept_shape;\r\n}\r\n\r\nprior simulations\r\n\r\n\r\nget_prior(gamma_form, data = data.frame(xx))\r\n\r\n\r\n                   prior     class coef group resp  dpar nlpar bound\r\n student_t(3, 15.8, 2.8) Intercept                                  \r\n       gamma(0.01, 0.01) Intercept                 shape            \r\n  source\r\n default\r\n default\r\n\r\nandrew_prior <- c(prior(normal(2, .3), class = \"Intercept\"),\r\n                  prior(normal(2, .4), class = \"Intercept\", dpar = \"shape\"))\r\n\r\n\r\n\r\n\r\n\r\n# visualizing in base R \r\n\r\nrnorm(4000, mean = 2, sd = .2) |> exp() |> hist()\r\n\r\n\r\n\r\n\r\n\r\n\r\ngamma_form <- bf(xx ~ 1,\r\n                 family = brmsfamily(\"Gamma\",\r\n                                     link = \"log\",\r\n                                     link_shape = \"log\")) + \r\n  lf(shape ~ 1)\r\n\r\ngamma_prior_predict <- brm(gamma_form, data = data.frame(xx), \r\n    prior = andrew_prior,\r\n    backend = \"cmdstanr\", cores = 4, sample_prior = \"only\", file = here::here(\"_posts\", \r\n                               \"2022-06-06-hybrid-fly-life-history\",\r\n                               \"gamma_prior_predict.rds\"))\r\n\r\n# visualize\r\ngamma_prior_predict |> \r\n  gather_draws( b_Intercept, b_shape_Intercept, ndraws = 6)\r\n\r\ndata.frame(nn = 1:450) |> \r\n  add_predicted_draws(gamma_prior_predict, ndraws = 12) |> \r\n  ggplot(aes(x = .prediction)) + \r\n  geom_histogram() + \r\n  facet_wrap(~.draw, ncol = 4)\r\n\r\n\r\n\r\nexperimental design\r\nH, N, and hybrid – three kinds of flies\r\nis development time different among the three lines? Does the\r\nvariance in development time differ between the lines?\r\nbegin by modelling one fly species, one life history stage\r\nusing the brms parameterization\r\n\r\n\r\n# larval development times\r\nhist(rgamma(570, shape = 30, rate = 30/12))\r\n\r\n\r\n\r\n# pupal development times\r\nhist(rgamma(570, shape = 30, rate = 30/13))\r\n\r\n\r\n\r\n\r\n\r\n\r\ngamma_form <- bf(xx ~ 1,\r\n                 family = brmsfamily(\"Gamma\",\r\n                                     link = \"log\",\r\n                                     link_shape = \"log\")) + \r\n  lf(shape ~ 1)\r\n\r\nsimple_gamma <- brm(gamma_form, \r\n                    data = data.frame(xx = rgamma(570,\r\n                                                  shape = 30,\r\n                                                  rate = 30/13)),\r\n                    here::here(\"_posts\", \r\n                               \"2022-06-06-hybrid-fly-life-history\",\r\n                               \"simple_gamma.rds\"),\r\n                    backend = \"cmdstanr\", cores = 4)\r\n\r\n\r\nRunning MCMC with 4 parallel chains...\r\n\r\nChain 2 Iteration:    1 / 2000 [  0%]  (Warmup) \r\nChain 3 Iteration:    1 / 2000 [  0%]  (Warmup) \r\nChain 4 Iteration:    1 / 2000 [  0%]  (Warmup) \r\nChain 1 Iteration:    1 / 2000 [  0%]  (Warmup) \r\nChain 1 Iteration:  100 / 2000 [  5%]  (Warmup) \r\nChain 2 Iteration:  100 / 2000 [  5%]  (Warmup) \r\nChain 3 Iteration:  100 / 2000 [  5%]  (Warmup) \r\nChain 4 Iteration:  100 / 2000 [  5%]  (Warmup) \r\nChain 2 Iteration:  200 / 2000 [ 10%]  (Warmup) \r\nChain 3 Iteration:  200 / 2000 [ 10%]  (Warmup) \r\nChain 1 Iteration:  200 / 2000 [ 10%]  (Warmup) \r\nChain 2 Iteration:  300 / 2000 [ 15%]  (Warmup) \r\nChain 4 Iteration:  200 / 2000 [ 10%]  (Warmup) \r\nChain 1 Iteration:  300 / 2000 [ 15%]  (Warmup) \r\nChain 3 Iteration:  300 / 2000 [ 15%]  (Warmup) \r\nChain 4 Iteration:  300 / 2000 [ 15%]  (Warmup) \r\nChain 2 Iteration:  400 / 2000 [ 20%]  (Warmup) \r\nChain 1 Iteration:  400 / 2000 [ 20%]  (Warmup) \r\nChain 2 Iteration:  500 / 2000 [ 25%]  (Warmup) \r\nChain 3 Iteration:  400 / 2000 [ 20%]  (Warmup) \r\nChain 4 Iteration:  400 / 2000 [ 20%]  (Warmup) \r\nChain 1 Iteration:  500 / 2000 [ 25%]  (Warmup) \r\nChain 2 Iteration:  600 / 2000 [ 30%]  (Warmup) \r\nChain 3 Iteration:  500 / 2000 [ 25%]  (Warmup) \r\nChain 4 Iteration:  500 / 2000 [ 25%]  (Warmup) \r\nChain 1 Iteration:  600 / 2000 [ 30%]  (Warmup) \r\nChain 3 Iteration:  600 / 2000 [ 30%]  (Warmup) \r\nChain 4 Iteration:  600 / 2000 [ 30%]  (Warmup) \r\nChain 1 Iteration:  700 / 2000 [ 35%]  (Warmup) \r\nChain 2 Iteration:  700 / 2000 [ 35%]  (Warmup) \r\nChain 3 Iteration:  700 / 2000 [ 35%]  (Warmup) \r\nChain 2 Iteration:  800 / 2000 [ 40%]  (Warmup) \r\nChain 4 Iteration:  700 / 2000 [ 35%]  (Warmup) \r\nChain 1 Iteration:  800 / 2000 [ 40%]  (Warmup) \r\nChain 2 Iteration:  900 / 2000 [ 45%]  (Warmup) \r\nChain 3 Iteration:  800 / 2000 [ 40%]  (Warmup) \r\nChain 4 Iteration:  800 / 2000 [ 40%]  (Warmup) \r\nChain 1 Iteration:  900 / 2000 [ 45%]  (Warmup) \r\nChain 3 Iteration:  900 / 2000 [ 45%]  (Warmup) \r\nChain 4 Iteration:  900 / 2000 [ 45%]  (Warmup) \r\nChain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) \r\nChain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) \r\nChain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) \r\nChain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) \r\nChain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) \r\nChain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) \r\nChain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) \r\nChain 1 Iteration: 1100 / 2000 [ 55%]  (Sampling) \r\nChain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) \r\nChain 2 Iteration: 1100 / 2000 [ 55%]  (Sampling) \r\nChain 1 Iteration: 1200 / 2000 [ 60%]  (Sampling) \r\nChain 3 Iteration: 1100 / 2000 [ 55%]  (Sampling) \r\nChain 4 Iteration: 1100 / 2000 [ 55%]  (Sampling) \r\nChain 2 Iteration: 1200 / 2000 [ 60%]  (Sampling) \r\nChain 3 Iteration: 1200 / 2000 [ 60%]  (Sampling) \r\nChain 4 Iteration: 1200 / 2000 [ 60%]  (Sampling) \r\nChain 1 Iteration: 1300 / 2000 [ 65%]  (Sampling) \r\nChain 2 Iteration: 1300 / 2000 [ 65%]  (Sampling) \r\nChain 3 Iteration: 1300 / 2000 [ 65%]  (Sampling) \r\nChain 4 Iteration: 1300 / 2000 [ 65%]  (Sampling) \r\nChain 1 Iteration: 1400 / 2000 [ 70%]  (Sampling) \r\nChain 1 Iteration: 1500 / 2000 [ 75%]  (Sampling) \r\nChain 2 Iteration: 1400 / 2000 [ 70%]  (Sampling) \r\nChain 3 Iteration: 1400 / 2000 [ 70%]  (Sampling) \r\nChain 4 Iteration: 1400 / 2000 [ 70%]  (Sampling) \r\nChain 1 Iteration: 1600 / 2000 [ 80%]  (Sampling) \r\nChain 2 Iteration: 1500 / 2000 [ 75%]  (Sampling) \r\nChain 3 Iteration: 1500 / 2000 [ 75%]  (Sampling) \r\nChain 4 Iteration: 1500 / 2000 [ 75%]  (Sampling) \r\nChain 2 Iteration: 1600 / 2000 [ 80%]  (Sampling) \r\nChain 1 Iteration: 1700 / 2000 [ 85%]  (Sampling) \r\nChain 3 Iteration: 1600 / 2000 [ 80%]  (Sampling) \r\nChain 4 Iteration: 1600 / 2000 [ 80%]  (Sampling) \r\nChain 1 Iteration: 1800 / 2000 [ 90%]  (Sampling) \r\nChain 2 Iteration: 1700 / 2000 [ 85%]  (Sampling) \r\nChain 3 Iteration: 1700 / 2000 [ 85%]  (Sampling) \r\nChain 4 Iteration: 1700 / 2000 [ 85%]  (Sampling) \r\nChain 1 Iteration: 1900 / 2000 [ 95%]  (Sampling) \r\nChain 2 Iteration: 1800 / 2000 [ 90%]  (Sampling) \r\nChain 3 Iteration: 1800 / 2000 [ 90%]  (Sampling) \r\nChain 1 Iteration: 2000 / 2000 [100%]  (Sampling) \r\nChain 4 Iteration: 1800 / 2000 [ 90%]  (Sampling) \r\nChain 1 finished in 3.1 seconds.\r\nChain 2 Iteration: 1900 / 2000 [ 95%]  (Sampling) \r\nChain 3 Iteration: 1900 / 2000 [ 95%]  (Sampling) \r\nChain 4 Iteration: 1900 / 2000 [ 95%]  (Sampling) \r\nChain 2 Iteration: 2000 / 2000 [100%]  (Sampling) \r\nChain 3 Iteration: 2000 / 2000 [100%]  (Sampling) \r\nChain 4 Iteration: 2000 / 2000 [100%]  (Sampling) \r\nChain 2 finished in 3.3 seconds.\r\nChain 3 finished in 3.3 seconds.\r\nChain 4 finished in 3.3 seconds.\r\n\r\nAll 4 chains finished successfully.\r\nMean chain execution time: 3.2 seconds.\r\nTotal execution time: 3.6 seconds.\r\n\r\nsimple_gamma |> \r\n  gather_rvars(Intercept, Intercept_shape) |> \r\n  mutate(.value = exp(.value)) |> \r\n  ggplot(aes(y = .variable, dist = .value)) + \r\n  stat_dist_halfeye()\r\n\r\n\r\n\r\n\r\nduration and variance are approximately (but not necessarily)\r\nequal\r\nStart with: many individuals all with the same expected duration of\r\neach life history stage.\r\ncorrelated both stages\r\n\r\n\r\ncorr_larva_pupa <- .8\r\n\r\ncorr_mat <- matrix(c(1, corr_larva_pupa,\r\n                     corr_larva_pupa, 1), byrow = TRUE, ncol = 2)\r\n\r\nlarv_sd <- .5\r\npupa_sd <- .7\r\n\r\nsds <- c(larv_sd, pupa_sd)\r\n\r\nSigma <- diag(sds) %*% corr_mat %*% diag(sds)\r\n\r\nlarv_pupa <- MASS::mvrnorm(570, mu = c(13, 13), Sigma = Sigma)\r\n\r\nplot(larv_pupa[,1], larv_pupa[,2])\r\n\r\n\r\n\r\n\r\nAdd observation variance\r\n\r\n\r\ntrue_shape <- 70\r\n\r\nfake_development_times <- tibble(fly_id = 1:570,\r\n       fly_code = paste0(\"fly\", fly_id)) |> \r\n  mutate(avg_larva = larv_pupa[fly_id, 1],\r\n         avg_pupae = larv_pupa[fly_id, 2]) |> \r\n  rowwise() |> \r\n  mutate(\r\n    # add observation variance\r\n    obs_larva = rgamma(1, shape = true_shape, rate = true_shape/avg_larva),\r\n    obs_pupae = rgamma(1, shape = true_shape, rate = true_shape/avg_pupae)\r\n  )\r\n\r\n\r\n\r\nplot, then model\r\n\r\n\r\nfake_development_times |> \r\n  ggplot(aes(x = obs_larva, y = obs_pupae)) + geom_point()\r\n\r\n\r\n\r\nfake_development_times |> \r\n  ggplot(aes(x = avg_larva, y = avg_pupae)) + geom_point()\r\n\r\n\r\n\r\n\r\ncorrelation is hard to see under the gamma errors!\r\nlet’s see if a model can recover that\r\n\r\n\r\nfake_devo_long <- fake_development_times |> \r\n  select(-starts_with(\"avg\")) |> \r\n  pivot_longer(starts_with(\"obs\"),\r\n               names_to = \"stage\",\r\n               values_to = \"days\")\r\n\r\n\r\ngamma_form_correlated_stages <- bf(days ~ stage + (1 + stage | fly_code),\r\n                 family = brmsfamily(\"Gamma\",\r\n                                     link = \"log\",\r\n                                     link_shape = \"log\")) + \r\n  lf(shape ~ 1)\r\n\r\n\r\nget_prior(gamma_form_correlated_stages, data = fake_devo_long)\r\n\r\n\r\n                  prior     class           coef    group resp  dpar\r\n                 (flat)         b                                   \r\n                 (flat)         b stageobs_pupae                    \r\n                 lkj(1)       cor                                   \r\n                 lkj(1)       cor                fly_code           \r\n student_t(3, 2.6, 2.5) Intercept                                   \r\n   student_t(3, 0, 2.5)        sd                                   \r\n   student_t(3, 0, 2.5)        sd                fly_code           \r\n   student_t(3, 0, 2.5)        sd      Intercept fly_code           \r\n   student_t(3, 0, 2.5)        sd stageobs_pupae fly_code           \r\n   student_t(3, 0, 2.5) Intercept                              shape\r\n nlpar bound       source\r\n                  default\r\n             (vectorized)\r\n                  default\r\n             (vectorized)\r\n                  default\r\n                  default\r\n             (vectorized)\r\n             (vectorized)\r\n             (vectorized)\r\n                  default\r\n\r\ncorr_stages_priors <- c(\r\n  prior(normal(0,1), class = \"b\"),\r\n  prior(lkj(2), class = \"cor\"),\r\n  prior(normal(2.5,1), class = \"Intercept\"),\r\n  prior(exponential(2), class = \"sd\"),\r\n  prior(normal(4,2), class = \"Intercept\", dpar = \"shape\")\r\n)\r\n\r\n\r\ncorrelated_stages_gamma <- brm(gamma_form_correlated_stages,\r\n                               data = fake_devo_long, \r\n                               prior = corr_stages_priors,\r\n                               file = here::here(\"_posts\", \"2022-06-06-hybrid-fly-life-history\", \"corr_gamma.rds\"),\r\n                               cores = 4)\r\n\r\ncorrelated_stages_gamma\r\n\r\n\r\n Family: gamma \r\n  Links: mu = log; shape = log \r\nFormula: days ~ stage + (1 + stage | fly_code) \r\n         shape ~ 1\r\n   Data: fake_devo_long (Number of observations: 1140) \r\n  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;\r\n         total post-warmup draws = 4000\r\n\r\nGroup-Level Effects: \r\n~fly_code (Number of levels: 570) \r\n                              Estimate Est.Error l-95% CI u-95% CI\r\nsd(Intercept)                     0.04      0.01     0.01     0.06\r\nsd(stageobs_pupae)                0.03      0.02     0.00     0.07\r\ncor(Intercept,stageobs_pupae)    -0.04      0.41    -0.73     0.77\r\n                              Rhat Bulk_ESS Tail_ESS\r\nsd(Intercept)                 1.01      292      565\r\nsd(stageobs_pupae)            1.02      245      286\r\ncor(Intercept,stageobs_pupae) 1.00      982     2074\r\n\r\nPopulation-Level Effects: \r\n                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS\r\nIntercept           2.56      0.01     2.55     2.57 1.00     3898\r\nshape_Intercept     4.20      0.07     4.06     4.35 1.01      345\r\nstageobs_pupae      0.01      0.01    -0.01     0.02 1.00     2033\r\n                Tail_ESS\r\nIntercept           2312\r\nshape_Intercept      415\r\nstageobs_pupae       613\r\n\r\nDraws were sampled using sampling(NUTS). For each parameter, Bulk_ESS\r\nand Tail_ESS are effective sample size measures, and Rhat is the potential\r\nscale reduction factor on split chains (at convergence, Rhat = 1).\r\n\r\nMaybe a simpler model (the above seems overparameterized) where each\r\nlarva has a single offset (e.g. proportional to “quality” or “resource\r\nuse efficiency”).\r\n\r\n\r\nnfly <- 570\r\n# average time you spend as a larva\r\nlog_avg_larva_time <-  log(13)\r\n# average time DIFFERECE to the time you spend as a pupa (might be close to 0)\r\nlog_to_pupa <- -.2\r\n# your \"quality\", some idea of how much above and below the population you are\r\nlog_indiv_quality <- rnorm(n = nfly, mean = 0, sd = .2)\r\n\r\nexp(log_avg_larva_time)\r\n\r\n\r\n[1] 13\r\n\r\nexp(log_avg_larva_time + log_to_pupa)\r\n\r\n\r\n[1] 10.6435\r\n\r\nfake_flies_intercept <- tibble(\r\n  fly_id = 1:570,\r\n  fly_code = paste0(\"fly\", fly_id)\r\n) |> \r\n  rowwise() |> \r\n  mutate(lh = list(data.frame(stage_id = c(0,1),\r\n                              stage_nm = c(\"larv\", \"pupa\"))))\r\n\r\ntrue_shape_intercept <- 72\r\n\r\nfake_intercept_obs <- fake_flies_intercept |> \r\n  unnest(cols = c(\"lh\")) |> \r\n  mutate(avg_duration = log_avg_larva_time + log_to_pupa*stage_id,\r\n         ecart_indiv = log_indiv_quality[fly_id],\r\n         fly_duration = avg_duration + ecart_indiv) |> \r\n  rowwise() |> \r\n  mutate(obs_duration = rgamma(1, true_shape_intercept, rate = true_shape_intercept/exp(fly_duration)))\r\n\r\nfake_intercept_obs |> \r\n  ggplot(aes(x = obs_duration, fill = stage_nm)) + geom_histogram()\r\n\r\n\r\n\r\n\r\n\r\n\r\nfake_intercept_obs |> \r\n  select(fly_id, stage_nm, obs_duration) |> \r\n  ungroup() |> \r\n  pivot_wider(names_from = stage_nm, values_from = obs_duration) |> \r\n  ggplot(aes(x = larv, y = pupa)) + geom_point()\r\n\r\n\r\n\r\n\r\nmodel to recover\r\n\r\n\r\ngamma_form_intercept <- bf(obs_duration ~ stage_nm + (1| fly_code),\r\n                                   family = brmsfamily(\"Gamma\",\r\n                                                       link = \"log\",\r\n                                                       link_shape = \"log\")) + \r\n  lf(shape ~ 1)\r\n\r\n\r\nget_prior(gamma_form_intercept, data = fake_intercept_obs)\r\n\r\n\r\n                  prior     class         coef    group resp  dpar\r\n                 (flat)         b                                 \r\n                 (flat)         b stage_nmpupa                    \r\n student_t(3, 2.5, 2.5) Intercept                                 \r\n   student_t(3, 0, 2.5)        sd                                 \r\n   student_t(3, 0, 2.5)        sd              fly_code           \r\n   student_t(3, 0, 2.5)        sd    Intercept fly_code           \r\n   student_t(3, 0, 2.5) Intercept                            shape\r\n nlpar bound       source\r\n                  default\r\n             (vectorized)\r\n                  default\r\n                  default\r\n             (vectorized)\r\n             (vectorized)\r\n                  default\r\n\r\nintercept_priors <- c(\r\n  prior(normal(0,1), class = \"b\"),\r\n  prior(normal(2.5,1), class = \"Intercept\"),\r\n  prior(exponential(2), class = \"sd\"),\r\n  prior(normal(4,2), class = \"Intercept\", dpar = \"shape\")\r\n)\r\n\r\n\r\nintercept_stages_gamma <- brm(gamma_form_intercept,\r\n                               data = fake_intercept_obs, \r\n                               prior = intercept_priors,\r\n                               file = here::here(\"_posts\", \"2022-06-06-hybrid-fly-life-history\", \"intercept_gamma.rds\"),\r\n                               cores = 4)\r\n\r\n\r\n\r\nGenetic lines\r\navg for one genotype\r\naverage for the second\r\ndiff between their average and the hybrid\r\nH, N, and hybrid\r\nWe can generate this with Helmert contrasts\r\n\r\n\r\nthree_helmerts_default <- contr.helmert(3)\r\nthree_helmerts <- sweep(cbind(1, three_helmerts_default), MARGIN = 2, STATS = 1:3, FUN = `/`)\r\nthree_helmerts\r\n\r\n\r\n  [,1] [,2]       [,3]\r\n1    1 -0.5 -0.3333333\r\n2    1  0.5 -0.3333333\r\n3    1  0.0  0.6666667\r\n\r\nsolve(three_helmerts)\r\n\r\n\r\n              1          2         3\r\n[1,]  0.3333333  0.3333333 0.3333333\r\n[2,] -1.0000000  1.0000000 0.0000000\r\n[3,] -0.5000000 -0.5000000 1.0000000\r\n\r\nWe have effects and we want to make group differences out of\r\nthem:\r\n\r\n\r\n# units in days\r\ngrand_mean <- 7\r\n# n develops 2 days slower\r\nh_n_contr <- 2\r\n# hybrids develop 5 days slower \r\nhybrid_effect <- 0\r\n\r\ngeno_names <- c(\"H\", \"N\", \"HN\")\r\n\r\nrownames(three_helmerts) <- geno_names\r\n\r\navg_effects <- tibble(geno = rep(geno_names, each = 20),\r\n       geno_mean = grand_mean*three_helmerts[geno, 1] + h_n_contr*three_helmerts[geno, 2] + hybrid_effect*three_helmerts[geno, 3])\r\n\r\navg_effects |> \r\n  ggplot(aes(x = factor(geno, levels = geno_names), y = geno_mean)) + geom_point()\r\n\r\n\r\n\r\ndistinct(avg_effects)\r\n\r\n\r\n# A tibble: 3 x 2\r\n  geno  geno_mean\r\n  <chr>     <dbl>\r\n1 H             6\r\n2 N             8\r\n3 HN            7\r\n\r\nThis also works on the log scale:\r\n\r\n\r\n# units in days\r\nlog_grand_mean <- log(7)\r\n# n develops 30% longer\r\nlog_h_n_contr <- log(1.3)\r\n# hybrids develop 10% longer than expected \r\nlog_hybrid_effect <- log(1.1)\r\n\r\navg_effects <- tibble(geno = rep(geno_names, each = 20),\r\n       geno_mean = log_grand_mean*three_helmerts[geno, 1] + \r\n         log_h_n_contr*three_helmerts[geno, 2] +\r\n         log_hybrid_effect*three_helmerts[geno, 3])\r\n\r\navg_effects |> \r\n  ggplot(aes(x = factor(geno, levels = geno_names), y = exp(geno_mean))) + \r\n  geom_point()\r\n\r\n\r\n\r\ndistinct(avg_effects) |> \r\n  mutate(exp(geno_mean))\r\n\r\n\r\n# A tibble: 3 x 3\r\n  geno  geno_mean `exp(geno_mean)`\r\n  <chr>     <dbl>            <dbl>\r\n1 H          1.78             5.95\r\n2 N          2.05             7.73\r\n3 HN         2.01             7.46\r\n\r\nextend this to variation\r\neffects\r\n\r\n\r\n# reminder of how the gamma works\r\n\r\nrr <- rgamma(3000, shape = exp(4), rate = exp(4)/30)\r\nhist(rr)\r\n\r\n\r\n\r\nmean(rr)\r\n\r\n\r\n[1] 30.01375\r\n\r\nvar(rr)\r\n\r\n\r\n[1] 16.01835\r\n\r\n30^2/exp(4)\r\n\r\n\r\n[1] 16.48407\r\n\r\nsd(rr)\r\n\r\n\r\n[1] 4.002293\r\n\r\n30/sqrt(exp(4))\r\n\r\n\r\n[1] 4.060058\r\n\r\ncurve(1/sqrt(exp(x)), xlim = c(-3, 6))\r\n\r\n\r\n\r\n\r\nUse parameterization of gamma used by brms: the parameter \\(\\alpha\\) scales the square of the variance\r\nto the mean.\r\n\r\n\r\n# start with shape = 1 for simplicity!\r\n\r\nlog_shape <- 6\r\nlibrary(ggridges)\r\navg_effects |> \r\n  mutate(obs_time = rgamma(nrow(avg_effects), shape = exp(log_shape), rate = exp(log_shape)/exp(geno_mean))) |> \r\n  ggplot(aes(y = geno, x = obs_time)) + \r\n  stat_density_ridges() + \r\n  coord_cartesian(xlim = c(2, 10))\r\n\r\n\r\n\r\n\r\nnow let\r\ngenotype control the variance AND the average\r\n\r\n\r\nshape_params <- c(grand_var = log(9), diff_h_n = log(1), hybrid_effect = log(.7))\r\nthree_helmerts %*% shape_params\r\n\r\n\r\n       [,1]\r\nH  2.316116\r\nN  2.316116\r\nHN 1.959441\r\n\r\nexp(three_helmerts %*% shape_params)\r\n\r\n\r\n        [,1]\r\nH  10.136231\r\nN  10.136231\r\nHN  7.095362\r\n\r\navg_var_effects <- avg_effects |> \r\n  # add shape AKA concentration parameters\r\n  mutate(geno_shape = shape_params[1]*three_helmerts[geno, 1] + \r\n           shape_params[2]*three_helmerts[geno, 2] +\r\n           shape_params[3]*three_helmerts[geno, 3])\r\n\r\ntime_observations_onestage <- avg_var_effects |> \r\n  mutate(obs_time = rgamma(nrow(avg_var_effects), shape = exp(geno_shape), rate = exp(geno_shape)/exp(geno_mean)))\r\n\r\n\r\ntime_observations_onestage |> \r\n  ggplot(aes(x = obs_time, y = geno)) + stat_density_ridges()\r\n\r\n\r\n\r\n\r\n\r\n\r\nnfly <- 570\r\n# average time you spend as a larva\r\nlog_avg_larva_time <-  log(13)\r\n# average time DIFFERECE to the time you spend as a pupa (might be close to 0)\r\nlog_to_pupa <- -.2\r\n# your \"quality\", some idea of how much above and below the population you are\r\nlog_indiv_quality <- rnorm(n = nfly, mean = 0, sd = .2)\r\n\r\nexp(log_avg_larva_time)\r\n\r\nexp(log_avg_larva_time + log_to_pupa)\r\n\r\ngenotype_vals <- tibble(genotype = rep(c(\"H\", \"N\", \"HN\"), each = 100),\r\n                        fly_id = 1:300) |> \r\n  rowwise() |> \r\n  mutate(lh = list(data.frame(stage_id = c(0,1),\r\n                              stage_nm = c(\"larv\", \"pupa\")))) |> \r\n  unnest(cols =\"lh\")\r\n\r\ntrue_shape_intercept <- 72\r\n\r\ngenotype_vals |> \r\n  rowwise() |> \r\n  mutate(avg_duration = \r\n           log_avg_larva_time + \r\n           log_to_pupa*stage_id +  \r\n           log_indiv_quality[fly_id] + genotype_mean[genotype])\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-06-06-hybrid-fly-life-history/hybrid-fly-life-history_files/figure-html5/unnamed-chunk-2-1.png",
    "last_modified": "2022-06-20T13:41:56-04:00",
    "input_file": "hybrid-fly-life-history.knit.md"
  },
  {
    "path": "posts/2022-05-26-fid-when-to-run-away/",
    "title": "FID: When to run away",
    "description": "Modelling a decay to a constant",
    "author": [
      {
        "name": "Nora Jones",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2022-05-26",
    "categories": [],
    "contents": "\r\n\\[\r\n\\begin{align}\r\n\\text{FID}_{crj} \\sim& \\text{Gamma}\\left(\\frac{\\mu_{cr}}{\\sigma^2}, \\frac{\\mu_{cr}^2}{\\sigma^2}\\right)\\\\\r\n\\mu_{cr} =& m_{cr} \\times 1000 \\times \\left( 1 - \\frac{p_{cr} \\times X_j}{d_{cr} + X_j}  \\right) \\\\\r\n\\text{logit}(m_{cr}) =& \\bar{m} + \\beta_{m,r} + m_{c,r}\\\\\r\n\\text{logit}(p_{cr}) =& \\bar{p} + \\beta_{p,r} + p_{c,r}\\\\\r\n\\text{log}(d_{cr})   =& \\bar{d} + \\beta_{d,r} + d_{c,r}\\\\\r\n\\begin{bmatrix}\r\nm_{r}\\\\\r\np_{r}\\\\\r\nd_{r}\r\n\\end{bmatrix} &\\sim \\text{MVnormal}\\left(\\begin{bmatrix}0\\\\0\\\\0\\end{bmatrix}, \\textbf{S}_{r}\\right)\r\n\\end{align}\r\n\\]\r\n\\[\r\n\\begin{align}\r\n\\text{FID}_i \\sim& \\text{Gamma}\\left(\\frac{\\mu_i}{\\sigma^2}, \\frac{\\mu_i^2}{\\sigma^2}\\right)\\\\\r\n\\mu_i =& m_i \\times 1000 \\times \\left( 1 - \\frac{p_i \\times \\text{Obs}}{d_i + \\text{Obs}}  \\right) \\\\\r\n\\text{logit}(m_i) =& \\bar{m} + \\beta_{m,\\text{risk}[i]} + m_{\\text{tamia}[i], \\text{risk}[i]}\\\\\r\n\\text{logit}(p_i) =& \\bar{p} + \\beta_{p,\\text{risk}[i]} + p_{\\text{tamia}[i], \\text{risk}[i]}\\\\\r\n\\text{log}(d_i)   =& \\bar{d} + \\beta_{d,\\text{risk}[i]} + d_{\\text{tamia}[i], \\text{risk}[i]}\\\\\r\n\\begin{bmatrix}\r\nm_{\\text{tamia}, \\text{risk}[i]}\\\\\r\np_{\\text{tamia}, \\text{risk}[i]}\\\\\r\nd_{\\text{tamia}, \\text{risk}[i]}\r\n\\end{bmatrix} &\\sim \\text{MVnormal}\\left(\\begin{bmatrix}0\\\\0\\\\0\\end{bmatrix}, \\textbf{S}_{\\text{risk}[i]}\\right)\r\n\\end{align}\r\n\\]\r\n\\(j\\) indicates the chipmunks present in each treatment, of which there are \\(J_r\\)\r\nput real numbers in? why not?\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
    "preview": "posts/2022-05-26-fid-when-to-run-away/fid-when-to-run-away_files/figure-html5/unnamed-chunk-1-1.png",
    "last_modified": "2022-06-06T09:54:34-04:00",
    "input_file": {}
  },
  {
    "path": "posts/welcome/",
    "title": "Welcome to Simulation of Ecological Data",
    "description": "Welcome to our new blog, Simulation of Ecological Data. We hope you enjoy \nreading what we have to say!",
    "author": [
      {
        "name": "Nora Jones",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2022-05-26",
    "categories": [],
    "contents": "\r\n\r\n\r\n\r\n",
    "preview": {},
    "last_modified": "2022-06-06T09:54:34-04:00",
    "input_file": {}
  }
]
